<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MongoDB Sharding vs PostgreSQL Partitioning</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <nav class="nav-menu" id="navMenu">
            <h2>MongoDB vs SQL</h2>
            <ul>
                <li><a href="index.html">🏠 Home</a></li>
                
                <li class="nav-accordion">
                    <div class="nav-category-header" onclick="toggleAccordion('competition')" role="button" tabindex="0" aria-expanded="false">
                        <span>Comparative Analysis</span>
                        <span class="accordion-icon" id="competition-icon">▼</span>
                    </div>
                    <ul class="nav-accordion-content" id="competition-content" role="region">
                        <li><a href="mongodb_vs_postgres_presentation.html">
                            <span class="mongodb-logo-icon" aria-hidden="true"></span>MongoDB vs PostgreSQL
                        </a></li>
                        <li><a href="mongodb_postgres_technical_presentation.html">
                            <span class="postgresql-logo-icon" aria-hidden="true"></span>Postgres Technical Comparison
                        </a></li>
                    </ul>
                </li>
                
                <li class="nav-accordion">
                    <div class="nav-category-header" onclick="toggleAccordion('architecture')" role="button" tabindex="0" aria-expanded="true">
                        <span>High Availability and Scalability</span>
                        <span class="accordion-icon rotated" id="architecture-icon">▼</span>
                    </div>
                    <ul class="nav-accordion-content expanded" id="architecture-content" role="region">
                        <li><a href="mongodb_replica_set_demo.html">🔄 High Availability</a></li>
                        <li><a href="horizontal_scaling_presentation.html" class="active">📈 Horizontal Scaling</a></li>
                    </ul>
                </li>
                
                <li class="nav-accordion">
                    <div class="nav-category-header" onclick="toggleAccordion('patterns')" role="button" tabindex="0" aria-expanded="false">
                        <span>Architecture Patterns</span>
                        <span class="accordion-icon" id="patterns-icon">▼</span>
                    </div>
                    <ul class="nav-accordion-content" id="patterns-content" role="region">
                        <li><a href="mongodb_architecture_overview.html">📋 Overview</a></li>
                        <li><a href="mongodb_microservices.html">🏗️ Microservices</a></li>
                        <li><a href="mongodb_rag.html">🤖 RAG Architecture</a></li>
                        <li><a href="mongodb_event_driven.html">⚡ Event-Driven</a></li>
                        <li><a href="mongodb_cqrs.html">🔄 CQRS + Event Sourcing</a></li>
                        <li><a href="mongodb_iot.html">🌐 IoT Pipeline</a></li>
                        <li><a href="mongodb_realtime_analytics.html">📊 Real-time Analytics</a></li>
                    </ul>
                </li>
                
                <li class="nav-accordion">
                    <div class="nav-category-header" onclick="toggleAccordion('development')" role="button" tabindex="0" aria-expanded="false">
                        <span>Application Development</span>
                        <span class="accordion-icon" id="development-icon">▼</span>
                    </div>
                    <ul class="nav-accordion-content" id="development-content" role="region">
                        <li><a href="orm_vs_natural_objects_presentation.html">🔧 ORM vs Natural Objects</a></li>  
                        <li><a href="schema_evolution_presentation.html">🚀 Schema Evolution</a></li>
                        <li><a href="arrays_embedded_docs_presentation.html">📊 Arrays & Embedded Docs</a></li>
                        <li><a href="aggregation_pipeline_presentation.html">⚡ Aggregation Pipeline</a></li>
                        <li><a href="mongo_postgres_cdc_presentation.html">🔄 Change Data Capture</a></li>
                    </ul>
                </li>
            </ul>
        </nav>

        <div class="nav-backdrop" id="navBackdrop" onclick="closeMobileMenu()"></div>

        <main class="main-content">
            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()" aria-label="Toggle navigation menu">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <header class="header">
                <h1>
                    <span class="mongodb-logo-icon" aria-hidden="true"></span>MongoDB Sharding vs 
                    <span class="postgresql-logo-icon" aria-hidden="true"></span>PostgreSQL Partitioning
                </h1>
                <p class="subtitle">Experience the difference between automatic horizontal scaling and manual partitioning</p>
            </header>

            <!-- Real Impact Box -->
            <div class="real-impact-container">
                <div class="real-impact-box">
                    <div class="real-impact-text">
                        <strong>Real Impact:</strong> MongoDB's automatic sharding reduces operational overhead by 90% compared to manual PostgreSQL partitioning, while providing seamless horizontal scaling and zero-downtime shard additions.
                    </div>
                </div>
            </div>

            <!-- Expandable Demo Overview -->
            <div class="demo-overview-section">
                <div class="demo-toggle-header" onclick="toggleDemoOverview()">
                    <h3 class="demo-toggle-title">📋 What This Demo Shows</h3>
                    <span id="demoToggle" class="demo-toggle-icon">▼</span>
                </div>
                
                <div id="demoOverview" style="display: none;" class="demo-content">
                    <div class="scenario-grid">
                        <div class="scenario-card mongo-scenario">
                            <h4 class="scenario-title mongo-title">🍃 MongoDB Sharding Scenario</h4>
                            <ul class="scenario-list">
                                <li>Automatic data distribution across multiple shards</li>
                                <li>Zero-downtime shard additions with automatic rebalancing</li>
                                <li>mongos router handles all query routing transparently</li>
                                <li>Built-in chunk migration and load balancing</li>
                                <li><strong>No application code changes required</strong></li>
                            </ul>
                        </div>
                        
                        <div class="scenario-card sql-scenario">
                            <h4 class="scenario-title sql-title">🐘 PostgreSQL Partitioning Scenario</h4>
                            <ul class="scenario-list">
                                <li>Manual table partitioning with explicit range definitions</li>
                                <li>Application-level routing logic required</li>
                                <li>Downtime needed for partition restructuring</li>
                                <li>Manual data migration between partitions</li>
                                <li><strong>Complex operational procedures</strong></li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="key-differences">
                        <h4>🔍 Key Differences You'll Experience</h4>
                        <div class="differences-grid">
                            <div class="difference-point">
                                <div class="point-icon">⚡</div>
                                <div class="point-content">
                                    <div class="point-title">Scaling Speed</div>
                                    <div class="point-description">Instant vs. hours of planning and downtime</div>
                                </div>
                            </div>
                            <div class="difference-point">
                                <div class="point-icon">🔧</div>
                                <div class="point-content">
                                    <div class="point-title">Operational Complexity</div>
                                    <div class="point-description">Single commands vs. complex procedures</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="controls">
            <h3>🎮 Demo Controls</h3>
            <button class="btn btn-primary" onclick="addDataFinal()">📈 Add 1000 Records</button>
            <button class="btn btn-primary" onclick="addShardFinal()">🔧 Add MongoDB Shard</button>
            <button class="btn btn-primary" onclick="resetFinal()">🔄 Reset Demo</button>
        </div>

        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-number" id="totalRecords">0</div>
                <div class="stat-label">Total Records</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="mongoShards">3</div>
                <div class="stat-label">MongoDB Shards</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="sqlPartitions">1</div>
                <div class="stat-label">SQL Partitions</div>
            </div>
        </div>

        <div class="commands-section">
            <h3>💻 Database Commands</h3>
            <div class="command-tabs">
                <button class="tab-btn active" onclick="showTabFinal('mongo')">MongoDB</button>
                <button class="tab-btn" onclick="showTabFinal('postgresql')">PostgreSQL</button>
            </div>
            <div id="mongo-content" class="tab-content active">
// Current MongoDB sharding commands
sh.enableSharding("ecommerce")
sh.shardCollection("ecommerce.users", {"user_id": 1})

// Query routing (automatic)
db.users.find({"user_id": 12345})  // → Routes to correct shard
db.users.find({"city": "SF"})     // → Broadcast query

// Add new shard (what you're doing)
sh.addShard("shard004/new-region:27017")
// ✅ Automatic rebalancing, zero downtime
            </div>
            <div id="postgresql-content" class="tab-content">
-- Manual PostgreSQL partitioning setup
CREATE TABLE users_partition_1 (
    CHECK (user_id >= 1 AND user_id <= 5000)
) INHERITS (users);

CREATE TABLE users_partition_2 (
    CHECK (user_id >= 5001 AND user_id <= 10000)
) INHERITS (users);

-- Application routing logic required
-- ⚠️ Downtime needed for restructuring
            </div>
        </div>

        <div class="architecture">
            <div class="arch-panel">
                <div class="arch-title"><span class="mongodb-logo-icon"></span>MongoDB Sharded Cluster</div>
                
                <div class="query-router">
                    🎯 mongos Query Router
                    <small>Automatic routing & load balancing</small>
                </div>
                
                <div class="shards-container" id="mongoContainer">
                    <!-- Shards will be added here -->
                </div>
            </div>

            <div class="arch-panel">
                <div class="arch-title sql"><span class="postgresql-logo-icon"></span>PostgreSQL Manual Partitioning</div>
                
                <div class="sql-router">
                    ⚙️ Application Logic + pgpool
                    <small>Manual routing & connection pooling</small>
                </div>
                
                <div class="shards-container sql" id="sqlContainer">
                    <!-- SQL partitions will be added here dynamically -->
                </div>
            </div>
        </div>

        <div class="log-container">
            <h3>📊 Activity Log</h3>
            <div class="log-content" id="logContainer"></div>
        </div>
    </div>

    <script>
        // Global state
        var totalRecords = 0;
        var mongoShardCount = 3;
        var sqlPartitionCount = 1;
        var mongoData = { shard1: 0, shard2: 0, shard3: 0 };
        var sqlData = [0]; // Array to hold data per partition

        // LOG FUNCTION
        function logFinal(message, type) {
            var container = document.getElementById('logContainer');
            if (container) {
                var entry = document.createElement('div');
                entry.className = 'log-entry ' + (type || '');
                entry.textContent = '[' + new Date().toLocaleTimeString() + '] ' + message;
                container.appendChild(entry);
                container.scrollTop = container.scrollHeight;
            }
        }

        function updateStatsFinal() {
            document.getElementById('totalRecords').textContent = totalRecords.toLocaleString();
            document.getElementById('mongoShards').textContent = mongoShardCount;
            document.getElementById('sqlPartitions').textContent = sqlPartitionCount;
        }

        function showTabFinal(tabName) {
            // Hide all tabs
            document.getElementById('mongo-content').classList.remove('active');
            document.getElementById('postgresql-content').classList.remove('active');
            
            // Remove active from buttons
            var buttons = document.querySelectorAll('.tab-btn');
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].classList.remove('active');
            }
            
            // Show selected tab
            document.getElementById(tabName + '-content').classList.add('active');
            event.target.classList.add('active');
        }

        function renderMongoShardsFinal() {
            var container = document.getElementById('mongoContainer');
            container.innerHTML = '';

            var locations = ['US-East', 'US-West', 'EU', 'Asia-Pacific', 'Canada', 'Australia', 'Brazil', 'India'];

            for (var i = 1; i <= mongoShardCount; i++) {
                var shard = document.createElement('div');
                shard.className = 'shard mongo';
                shard.id = 'mongoShard' + i;
                
                if (i === mongoShardCount && mongoShardCount > 3) {
                    shard.classList.add('new-shard');
                }

                var records = mongoData['shard' + i] || 0;
                var percentage = totalRecords > 0 ? Math.round((records / totalRecords) * 100) : 0;
                var location = locations[i - 1] || 'Region-' + i;
                
                // Calculate range for display
                var rangeStart = ((i - 1) * 10000) + 1;
                var rangeEnd = i * 10000;
                var rangeText = 'Range: ' + rangeStart + '-' + rangeEnd;

                shard.innerHTML = 
                    '<div class="shard-title">Shard ' + i + '</div>' +
                    '<div><strong>' + location + '</strong></div>' +
                    '<div>' + records.toLocaleString() + ' docs</div>' +
                    '<div style="color: #00684A; font-weight: 600;">(' + percentage + '%)</div>' +
                    '<div style="font-size: 0.8em; color: #666; margin-top: 5px;">' + rangeText + '</div>';

                container.appendChild(shard);
            }

            logFinal('✅ MongoDB cluster updated - ' + mongoShardCount + ' shards active');
        }

        function renderSqlPartitionsFinal() {
            var container = document.getElementById('sqlContainer');
            container.innerHTML = '';

            for (var i = 1; i <= sqlPartitionCount; i++) {
                var partition = document.createElement('div');
                partition.className = 'shard sql';
                
                var records = sqlData[i - 1] || 0;
                var percentage = totalRecords > 0 ? Math.round((records / totalRecords) * 100) : 0;
                
                // Calculate range for display
                var rangeStart = ((i - 1) * 10000) + 1;
                var rangeEnd = i * 10000;
                var rangeText = 'user_id: ' + rangeStart + '-' + rangeEnd;

                partition.innerHTML = 
                    '<div class="shard-title sql">Partition ' + i + '</div>' +
                    '<div><strong>' + rangeText + '</strong></div>' +
                    '<div>' + records.toLocaleString() + ' records</div>' +
                    '<div style="color: #D32F2F; font-weight: 600;">(' + percentage + '%)</div>';

                container.appendChild(partition);
            }
        }

        function addDataFinal() {
            totalRecords += 1000;

            // Add data to SQL (all goes to first partition initially)
            sqlData[0] += 1000;

            // Check if we need to create new SQL partition
            if (totalRecords > 10000 && sqlPartitionCount === 1) {
                sqlPartitionCount = 2;
                sqlData.push(0);
                
                // Redistribute existing data
                var halfData = Math.floor(sqlData[0] / 2);
                sqlData[1] = halfData;
                sqlData[0] = sqlData[0] - halfData;
                
                logFinal('⚠️ SQL: DOWNTIME REQUIRED for data migration and app updates', 'sql');
                logFinal('🔧 SQL: Application routing logic must be updated manually', 'sql');
            } else if (sqlPartitionCount > 1) {
                // Distribute new data across existing partitions
                var perPartition = Math.floor(1000 / sqlPartitionCount);
                var remainder = 1000 % sqlPartitionCount;
                for (var i = 0; i < sqlPartitionCount; i++) {
                    sqlData[i] += perPartition + (i < remainder ? 1 : 0);
                }
            }

            // Distribute across MongoDB shards (automatic)
            var perShard = Math.floor(1000 / mongoShardCount);
            var remainder = 1000 % mongoShardCount;

            for (var i = 1; i <= mongoShardCount; i++) {
                var additional = perShard + (i <= remainder ? 1 : 0);
                mongoData['shard' + i] = (mongoData['shard' + i] || 0) + additional;
            }

            updateStatsFinal();
            renderMongoShardsFinal();
            renderSqlPartitionsFinal();

            logFinal('📈 Added 1000 records (Total: ' + totalRecords.toLocaleString() + ')');
            logFinal('✅ MongoDB: Auto-distributed via mongos router', 'command');
            
            if (sqlPartitionCount > 1) {
                logFinal('⚠️ SQL: Data distributed across ' + sqlPartitionCount + ' partitions with manual routing', 'sql');
            } else {
                logFinal('⚠️ SQL: All records in single partition - monitoring capacity', 'sql');
            }
        }

        function addShardFinal() {
            mongoShardCount++;
            var newShardKey = 'shard' + mongoShardCount;
            mongoData[newShardKey] = 0;

            var locations = ['US-East', 'US-West', 'EU', 'Asia-Pacific', 'Canada', 'Australia', 'Brazil', 'India'];
            var newLocation = locations[mongoShardCount - 1] || 'Region-' + mongoShardCount;

            logFinal('🔧 DBA Command: sh.addShard("' + newLocation.toLowerCase() + ':27017")', 'command');
            logFinal('🎯 mongos discovering new shard and updating routing tables', 'command');

            // Automatic rebalancing
            var totalData = 0;
            for (var key in mongoData) {
                totalData += mongoData[key];
            }

            if (totalData > 0) {
                var targetPerShard = Math.floor(totalData / mongoShardCount);
                var remainder = totalData % mongoShardCount;

                // Redistribute data
                for (var i = 1; i <= mongoShardCount; i++) {
                    mongoData['shard' + i] = targetPerShard + (i <= remainder ? 1 : 0);
                }
            }

            updateStatsFinal();
            renderMongoShardsFinal();

            logFinal('⚖️ Automatic chunk migration started by balancer', 'command');
            logFinal('✅ Shard ' + mongoShardCount + ' (' + newLocation + ') integrated with zero downtime');
            logFinal('⚠️ SQL equivalent: Manual partition + app code changes + downtime', 'sql');

            // Remove highlighting after animation
            setTimeout(function() {
                var newShard = document.getElementById('mongoShard' + mongoShardCount);
                if (newShard) {
                    newShard.classList.remove('new-shard');
                    logFinal('🎯 Shard ' + mongoShardCount + ' balancing completed - production ready');
                }
            }, 3000);
        }

        function resetFinal() {
            totalRecords = 0;
            mongoShardCount = 3;
            sqlPartitionCount = 1;
            mongoData = { shard1: 0, shard2: 0, shard3: 0 };
            sqlData = [0];

            updateStatsFinal();
            renderMongoShardsFinal();
            renderSqlPartitionsFinal();
            
            document.getElementById('logContainer').innerHTML = '';

            logFinal('🔄 Demo reset to initial 3-shard configuration');
            logFinal('📊 MongoDB: Ready for horizontal scaling demonstration');
            logFinal('🗄️ SQL: Single partition, manual scaling required');
            logFinal('🚀 Try adding data and shards to see the difference!');
        }

        function toggleDemoOverview() {
            var overview = document.getElementById('demoOverview');
            var toggle = document.getElementById('demoToggle');
            
            if (overview.style.display === 'none') {
                overview.style.display = 'block';
                toggle.textContent = '▲';
            } else {
                overview.style.display = 'none';
                toggle.textContent = '▼';
            }
        }

        // Navigation Functions
        function toggleAccordion(categoryId) {
            const content = document.getElementById(categoryId + '-content');
            const icon = document.getElementById(categoryId + '-icon');
            const header = content.previousElementSibling;
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                icon.classList.remove('rotated');
                header.setAttribute('aria-expanded', 'false');
            } else {
                content.classList.add('expanded');
                icon.classList.add('rotated');
                header.setAttribute('aria-expanded', 'true');
            }
        }

        function initializeAccordion() {
            // Auto-expand architecture section since this is a scaling demo
            const archContent = document.getElementById('architecture-content');
            const archIcon = document.getElementById('architecture-icon');
            const archHeader = archContent.previousElementSibling;
            
            if (archContent && archIcon && archHeader) {
                archContent.classList.add('expanded');
                archIcon.classList.add('rotated');
                archHeader.setAttribute('aria-expanded', 'true');
            }
        }

        function toggleMobileMenu() {
            const navMenu = document.getElementById('navMenu');
            const backdrop = document.getElementById('navBackdrop');
            if (navMenu) navMenu.classList.toggle('open');
            if (backdrop) backdrop.classList.toggle('active');
        }

        function closeMobileMenu() {
            const navMenu = document.getElementById('navMenu');
            const backdrop = document.getElementById('navBackdrop');
            if (navMenu) navMenu.classList.remove('open');
            if (backdrop) backdrop.classList.remove('active');
        }

        // Initialize accordion - expand category containing current page
        window.onload = function() {
            initializeAccordion();
            logFinal('🎉 MongoDB vs SQL horizontal scaling demo initialized');
            logFinal('🔧 MongoDB sharded cluster with mongos router active');
            logFinal('🗄️ SQL manual partitioning setup ready for comparison');
            renderMongoShardsFinal();
            renderSqlPartitionsFinal();
            updateStatsFinal();
            logFinal('✅ Demo ready - click buttons to see scaling in action!');
        };
    </script>
</body>
</html>
            for (var i = 1; i <= mongoShardCount; i++) {
                var additional = perShard + (i <= remainder ? 1 : 0);
                mongoData['shard' + i] = (mongoData['shard' + i] || 0) + additional;
            }

            updateStatsFinal();
            renderMongoShardsFinal();
            renderSqlPartitionsFinal();

            logFinal('📈 Added 1000 records (Total: ' + totalRecords.toLocaleString() + ')');
            logFinal('✅ MongoDB: Auto-distributed via mongos router', 'command');
            
            if (sqlPartitionCount > 1) {
                logFinal('⚠️ SQL: Data distributed across ' + sqlPartitionCount + ' partitions with manual routing', 'sql');
            } else {
                logFinal('⚠️ SQL: All records in single partition - monitoring capacity', 'sql');
            }
        }

        function addShardFinal() {
            mongoShardCount++;
            var newShardKey = 'shard' + mongoShardCount;
            mongoData[newShardKey] = 0;

            var locations = ['US-East', 'US-West', 'EU', 'Asia-Pacific', 'Canada', 'Australia', 'Brazil', 'India'];
            var newLocation = locations[mongoShardCount - 1] || 'Region-' + mongoShardCount;

            logFinal('🔧 DBA Command: sh.addShard("' + newLocation.toLowerCase() + ':27017")', 'command');
            logFinal('🎯 mongos discovering new shard and updating routing tables', 'command');

            // Automatic rebalancing
            var totalData = 0;
            for (var key in mongoData) {
                totalData += mongoData[key];
            }
            
            var perShard = Math.floor(totalData / mongoShardCount);
            var remainder = totalData % mongoShardCount;

            for (var i = 1; i <= mongoShardCount; i++) {
                mongoData['shard' + i] = perShard + (i <= remainder ? 1 : 0);
            }

            updateStatsFinal();
            renderMongoShardsFinal();

            logFinal('⚖️ Automatic chunk migration started by balancer', 'command');
            logFinal('✅ Shard ' + mongoShardCount + ' (' + newLocation + ') integrated with zero downtime');
            logFinal('⚠️ SQL equivalent: Manual partition + app code changes + downtime', 'sql');

            // Remove highlighting after animation
            setTimeout(function() {
                var newShard = document.getElementById('mongoShard' + mongoShardCount);
                if (newShard) {
                    newShard.classList.remove('new-shard');
                    logFinal('🎯 Shard ' + mongoShardCount + ' balancing completed - production ready');
                }
            }, 3000);
        }

        function resetFinal() {
            totalRecords = 0;
            mongoShardCount = 3;
            sqlPartitionCount = 1;
            mongoData = { shard1: 0, shard2: 0, shard3: 0 };
            sqlData = [0];

            updateStatsFinal();
            renderMongoShardsFinal();
            renderSqlPartitionsFinal();
            
            document.getElementById('logContainer').innerHTML = '';

            logFinal('🔄 Demo reset to initial 3-shard configuration');
            logFinal('📊 MongoDB: Ready for horizontal scaling demonstration');
            logFinal('🗄️ SQL: Single partition, manual scaling required');
            logFinal('🚀 Try adding data and shards to see the difference!');
        }

        // Toggle demo overview section
        function toggleDemoOverview() {
            var overview = document.getElementById('demoOverview');
            var toggle = document.getElementById('demoToggle');
            
            if (overview.style.display === 'none') {
                overview.style.display = 'block';
                toggle.textContent = '▲';
                toggle.style.transform = 'rotate(180deg)';
            } else {
                overview.style.display = 'none';
                toggle.textContent = '▼';
                toggle.style.transform = 'rotate(0deg)';
            }
        }

        // Navigation Functions
        function toggleAccordion(categoryId) {
            const content = document.getElementById(categoryId + '-content');
            const icon = document.getElementById(categoryId + '-icon');
            const header = content.previousElementSibling;
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                icon.classList.remove('rotated');
                header.setAttribute('aria-expanded', 'false');
            } else {
                content.classList.add('expanded');
                icon.classList.add('rotated');
                header.setAttribute('aria-expanded', 'true');
            }
        }

        function initializeAccordion() {
            // Auto-expand architecture section since this is a scaling demo
            const architectureContent = document.getElementById('architecture-content');
            const architectureIcon = document.getElementById('architecture-icon');
            const architectureHeader = architectureContent.previousElementSibling;
            
            if (architectureContent && architectureIcon && architectureHeader) {
                architectureContent.classList.add('expanded');
                architectureIcon.classList.add('rotated');
                architectureHeader.setAttribute('aria-expanded', 'true');
            }
        }

        function toggleMobileMenu() {
            const navMenu = document.getElementById('navMenu');
            const backdrop = document.getElementById('navBackdrop');
            if (navMenu) navMenu.classList.toggle('open');
            if (backdrop) backdrop.classList.toggle('active');
        }

        function closeMobileMenu() {
            const navMenu = document.getElementById('navMenu');
            const backdrop = document.getElementById('navBackdrop');
            if (navMenu) navMenu.classList.remove('open');
            if (backdrop) backdrop.classList.remove('active');
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const navMenu = document.getElementById('navMenu');
            const toggleButton = document.querySelector('.mobile-menu-toggle');
            
            if (!navMenu.contains(event.target) && !toggleButton.contains(event.target)) {
                closeMobileMenu();
            }
        });

        // Keyboard support
        document.addEventListener('keydown', function(event) {
            // ESC key closes menu
            if (event.key === 'Escape') {
                closeMobileMenu();
            }
        });

        // Initialize accordion - expand category containing current page
        window.onload = function() {
            initializeAccordion();
            logFinal('🎉 MongoDB vs SQL horizontal scaling demo initialized');
            logFinal('🔧 MongoDB sharded cluster with mongos router active');
            logFinal('🗄️ SQL manual partitioning setup ready for comparison');
            renderMongoShardsFinal();
            renderSqlPartitionsFinal();
            updateStatsFinal();
            logFinal('✅ Demo ready - click buttons to see scaling in action!');
        };
    </script>
</body>
</html>
