<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YCV5KGB8ES"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-YCV5KGB8ES');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arrays & Embedded Documents: MongoDB vs Relational</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Akzidenz', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #001E2B 0%, #00684A 50%, #00ED64 100%);
            color: #001E2B;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
        }

        .nav-menu {
            width: 300px;
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            box-shadow: 4px 0 20px rgba(0, 30, 43, 0.15);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            border-right: 1px solid rgba(0, 237, 100, 0.2);
        }

        .nav-menu h2 {
            margin-bottom: 25px;
            color: #00684A;
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 3px solid #00ED64;
            font-size: 1.4em;
            font-weight: 700;
            background: linear-gradient(45deg, #00ED64, #00B84D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-menu ul {
            list-style: none;
        }

        .nav-menu li {
            margin-bottom: 12px;
        }

        .nav-menu a {
            display: block;
            padding: 12px 18px;
            text-decoration: none;
            color: #001E2B;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            font-weight: 500;
        }

        .nav-menu a:hover, .nav-menu a.active {
            background: linear-gradient(135deg, #E8F5E8 0%, #F0FFF0 100%);
            border-left: 4px solid #00ED64;
            transform: translateX(8px);
            color: #00684A;
            box-shadow: 0 4px 12px rgba(0, 237, 100, 0.2);
        }

        .nav-category {
            font-weight: 700;
            color: #00684A;
            margin-top: 30px;
            margin-bottom: 15px;
            padding: 10px 18px;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid rgba(0, 237, 100, 0.3);
            background: linear-gradient(135deg, rgba(0, 237, 100, 0.1), rgba(0, 184, 77, 0.1));
            border-radius: 6px;
        }

        .nav-category:first-of-type {
            margin-top: 20px;
        }

        .mobile-menu-toggle {
            display: none;
        }

        .container {
            flex: 1;
            margin-left: 300px;
            max-width: none;
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 15px;
            font-weight: 700;
            background: linear-gradient(45deg, #00ED64, #00B84D);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
        }

        .header p {
            font-size: 1.3em;
            opacity: 0.9;
            font-weight: 400;
        }

        .so-what-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin: 25px auto;
            max-width: 900px;
            box-shadow: 0 8px 32px rgba(0, 30, 43, 0.15);
            border: 1px solid rgba(0, 237, 100, 0.2);
        }

        .so-what-title {
            color: #00684A;
            margin-bottom: 20px;
            font-size: 1.5em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .so-what-text {
            color: #001E2B;
            font-size: 1.1em;
            line-height: 1.7;
            margin-bottom: 20px;
            font-weight: 400;
        }

        .real-impact-box {
            background: linear-gradient(135deg, #E8F5E8 0%, #F0FFF0 100%);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #00ED64;
            margin-top: 20px;
        }

        .real-impact-text {
            color: #001E2B;
            font-weight: 600;
            font-size: 1.05em;
        }

        .demo-overview-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 25px;
            margin: 25px auto;
            max-width: 900px;
            box-shadow: 0 8px 32px rgba(0, 30, 43, 0.15);
            border: 1px solid rgba(0, 237, 100, 0.2);
        }

        .demo-toggle-header {
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .demo-toggle-header:hover {
            transform: translateY(-2px);
        }

        .demo-toggle-title {
            color: #001E2B;
            margin: 0;
            font-size: 1.4em;
            font-weight: 600;
        }

        .demo-toggle-icon {
            color: #00684A;
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }

        .demo-content {
            margin-top: 25px;
            padding-top: 25px;
            border-top: 2px solid #E8F5E8;
        }

        .scenario-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        .scenario-card {
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 30, 43, 0.1);
        }

        .mongo-scenario {
            background: linear-gradient(135deg, #E8F5E8 0%, #F0FFF0 100%);
            border: 1px solid #00ED64;
        }

        .sql-scenario {
            background: linear-gradient(135deg, #FDE8E8 0%, #FFF0F0 100%);
            border: 1px solid #FF6B6B;
        }

        .scenario-title {
            margin-bottom: 15px;
            font-weight: 600;
            font-size: 1.2em;
        }

        .mongo-title {
            color: #00684A;
        }

        .sql-title {
            color: #D32F2F;
        }

        .scenario-list {
            color: #001E2B;
            line-height: 1.7;
            margin: 0;
            padding-left: 20px;
        }

        .scenario-list li {
            margin-bottom: 8px;
        }

        .scenario-list strong {
            color: #00684A;
        }

        .sql-scenario .scenario-list strong {
            color: #D32F2F;
        }

        .learning-points {
            background: linear-gradient(135deg, #F8F9FA 0%, #FFFFFF 100%);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid #E8F5E8;
        }

        .learning-title {
            color: #001E2B;
            margin-bottom: 20px;
            font-weight: 600;
            font-size: 1.2em;
        }

        .points-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .learning-point {
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 30, 43, 0.05);
            border-left: 3px solid #00ED64;
        }

        .point-title {
            color: #00684A;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .point-description {
            color: #001E2B;
            font-size: 0.95em;
            opacity: 0.8;
        }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .side {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 30, 43, 0.15);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0, 237, 100, 0.2);
        }

        .side::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #00ED64, #00B84D);
        }

        .side.relational::before {
            background: linear-gradient(90deg, #FF6B6B, #D32F2F);
        }

        .side h2 {
            color: #00684A;
            margin-bottom: 20px;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .side.relational h2 {
            color: #D32F2F;
        }

        .logo {
            width: 40px;
            height: 40px;
            background: #00684A;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2em;
        }

        .logo.relational {
            background: #D32F2F;
        }

        .feature-section {
            margin-bottom: 30px;
        }

        .feature-title {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #00ED64;
            font-size: 1.2em;
            font-weight: bold;
        }

        .feature-title.relational {
            border-left-color: #FF6B6B;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 10px 0;
            overflow-x: auto;
        }

        .simulation-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid #e9ecef;
        }

        .simulation-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn-primary {
            background: #00684A;
            color: white;
        }

        .btn-primary:hover {
            background: #00523A;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #FF6B6B;
            color: white;
        }

        .btn-danger:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .data-display {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            min-height: 200px;
            overflow-y: auto;
            max-height: 400px;
            white-space: pre-wrap;
        }

        .query-demo {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #00ED64;
        }

        .query-demo.relational {
            background: #fde8e8;
            border-left-color: #FF6B6B;
        }

        .query-demo h4 {
            color: #00684A;
            margin-bottom: 10px;
        }

        .query-demo.relational h4 {
            color: #D32F2F;
        }

        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #00ED64;
            background: rgba(0, 237, 100, 0.1);
            font-size: 0.9em;
        }

        .log-entry.error {
            border-left-color: #FF6B6B;
            background: rgba(255, 107, 107, 0.1);
        }

        .benefits {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .benefits.relational {
            background: #fde8e8;
        }

        .benefits h4 {
            color: #00684A;
            margin-bottom: 10px;
        }

        .benefits.relational h4 {
            color: #D32F2F;
        }

        .icon {
            display: inline-block;
            margin-right: 5px;
        }

        .table-display {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            margin: 10px 0;
            overflow-x: auto;
        }

        .table-section {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #4a5568;
        }

        .table-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .table-title {
            color: #81c784;
            font-weight: bold;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .nav-menu {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                z-index: 1000;
            }
            
            .nav-menu.open {
                transform: translateX(0);
            }
            
            .container {
                margin-left: 0;
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .mobile-menu-toggle {
                display: block;
                position: fixed;
                top: 20px;
                left: 20px;
                z-index: 1001;
                background: linear-gradient(135deg, #00ED64, #00B84D);
                color: #001E2B;
                border: none;
                padding: 12px;
                border-radius: 8px;
                cursor: pointer;
                font-size: 1.2em;
                box-shadow: 0 4px 12px rgba(0, 237, 100, 0.3);
            }

            .comparison {
                grid-template-columns: 1fr;
            }
            
            .side {
                padding: 20px;
            }
            
            .simulation-controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }

            .scenario-grid {
                grid-template-columns: 1fr;
            }

            .points-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 1024px) {
            .nav-menu {
                width: 280px;
            }
            
            .container {
                margin-left: 280px;
                padding: 25px;
            }
        }

        /* Accordion Styles */
        .nav-accordion {
            margin-bottom: 8px;
        }

        .nav-category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 18px;
            background: linear-gradient(135deg, rgba(0, 237, 100, 0.1), rgba(0, 184, 77, 0.1));
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 700;
            color: #00684A;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 1px solid rgba(0, 237, 100, 0.2);
        }

        .nav-category-header:hover {
            background: linear-gradient(135deg, rgba(0, 237, 100, 0.2), rgba(0, 184, 77, 0.2));
            transform: translateX(4px);
        }

        .accordion-icon {
            transition: transform 0.3s ease;
            font-size: 0.8em;
            color: #00684A;
        }

        .accordion-icon.rotated {
            transform: rotate(180deg);
        }

        .nav-accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .nav-accordion-content.expanded {
            max-height: 300px;
        }

        .nav-accordion-content li {
            margin-bottom: 8px;
            margin-left: 15px;
        }

        .nav-accordion-content a {
            display: block;
            padding: 10px 15px;
            text-decoration: none;
            color: #001E2B;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 6px;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            font-weight: 500;
            font-size: 0.9em;
        }

        .nav-accordion-content a:hover, .nav-accordion-content a.active {
            background: linear-gradient(135deg, #E8F5E8 0%, #F0FFF0 100%);
            border-left: 3px solid #00ED64;
            transform: translateX(6px);
            color: #00684A;
            box-shadow: 0 3px 10px rgba(0, 237, 100, 0.2);
        }
    </style>
</head>
<body>
    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">☰</button>
    
    <div class="nav-menu" id="navMenu">
        <h2>MongoDB vs SQL</h2>
        <ul>
            <li><a href="index.html">🏠 Home</a></li>
            
            <li class="nav-accordion">
                <div class="nav-category-header" onclick="toggleAccordion('architecture')">
                    <span>Architecture & Performance</span>
                    <span class="accordion-icon" id="architecture-icon">▼</span>
                </div>
                <ul class="nav-accordion-content" id="architecture-content">
                    <li><a href="mongodb_replica_set_demo.html">🔄 High Availability</a></li>
                    <li><a href="horizontal_scaling_presentation.html">📈 Horizontal Scaling</a></li>
                </ul>
            </li>
            
            <li class="nav-accordion">
                <div class="nav-category-header" onclick="toggleAccordion('development')">
                    <span>Application Development</span>
                    <span class="accordion-icon" id="development-icon">▼</span>
                </div>
                <ul class="nav-accordion-content" id="development-content">
                    <li><a href="orm_vs_natural_objects_presentation.html">🔧 ORM vs Natural Objects</a></li>  
                    <li><a href="schema_evolution_presentation.html">🚀 Schema Evolution</a></li>
                    <li><a href="arrays_embedded_docs_presentation.html" class="active">📊 Arrays & Embedded Docs</a></li>
                    <li><a href="aggregation_pipeline_presentation.html">⚡ Aggregation Pipeline</a></li>
                </ul>
            </li>
        </ul>
    </div>

    <div class="container">
        <div class="header">
            <h1>Arrays & Embedded Documents</h1>
            <p>MongoDB's Native Support vs Relational Database Approach</p>
            
            <!-- So What Section -->
            <div class="so-what-section">
                <h2 class="so-what-title">🚀 Why This Matters: The Natural Data Advantage</h2>
                <p class="so-what-text">
                    Most applications deal with <strong>complex, nested data</strong> - users with multiple skills, orders with line items, blog posts with tags. Relational databases force you to break these natural relationships into separate tables, requiring complex JOINs that hurt performance and complicate your code.
                </p>
                <p class="so-what-text">
                    <strong>MongoDB's differentiator:</strong> Store data the way your application thinks about it. Arrays and embedded documents let you model real-world relationships naturally, eliminate JOINs, and retrieve complete objects in a single query.
                </p>
                <div class="real-impact-box">
                    <div class="real-impact-text">
                        <strong>Real Impact:</strong> 50-80% fewer database queries, simpler application code, and blazing-fast performance for complex data relationships that would require multiple JOINs in SQL.
                    </div>
                </div>
            </div>

            <!-- Expandable Demo Overview -->
            <div class="demo-overview-section">
                <div class="demo-toggle-header" onclick="toggleDemoOverview()">
                    <h3 class="demo-toggle-title">📋 What This Demo Shows</h3>
                    <span id="demoToggle" class="demo-toggle-icon">▼</span>
                </div>
                
                <div id="demoOverview" style="display: none;" class="demo-content">
                    <div class="scenario-grid">
                        <div class="scenario-card mongo-scenario">
                            <h4 class="scenario-title mongo-title">🍃 MongoDB Scenario</h4>
                            <ul class="scenario-list">
                                <li>Blog post with multiple tags stored as <strong>native array</strong></li>
                                <li>E-commerce order with customer data and line items <strong>embedded</strong></li>
                                <li>Single query retrieves complete objects</li>
                                <li>Rich query operators for arrays and nested documents</li>
                                <li><strong>No JOINs, maximum performance</strong></li>
                            </ul>
                        </div>
                        
                        <div class="scenario-card sql-scenario">
                            <h4 class="scenario-title sql-title">🗄️ SQL Scenario</h4>
                            <ul class="scenario-list">
                                <li>Blog tags require <strong>separate junction table</strong></li>
                                <li>Order data split across <strong>4+ tables</strong></li>
                                <li>Complex JOINs needed for simple queries</li>
                                <li>Foreign key management overhead</li>
                                <li><strong>Performance penalty, code complexity</strong></li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="learning-points">
                        <h4 class="learning-title">🎯 Key Learning Points</h4>
                        <div class="points-grid">
                            <div class="learning-point">
                                <div class="point-title">📊 Data Modeling</div>
                                <div class="point-description">See how MongoDB mirrors real-world object relationships</div>
                            </div>
                            <div class="learning-point">
                                <div class="point-title">⚡ Query Performance</div>
                                <div class="point-description">Compare single queries vs. complex JOINs</div>
                            </div>
                            <div class="learning-point">
                                <div class="point-title">🔍 Query Operators</div>
                                <div class="point-description">Explore MongoDB's rich array and object query capabilities</div>
                            </div>
                            <div class="learning-point">
                                <div class="point-title">🏗️ Schema Complexity</div>
                                <div class="point-description">Simple documents vs. normalized table structures</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="comparison">
            <!-- MongoDB Side -->
            <div class="side mongodb">
                <h2>
                    <div class="logo">M</div>
                    MongoDB Approach
                </h2>

                <!-- Arrays Section -->
                <div class="feature-section">
                    <div class="feature-title">📊 Native Array Support</div>
                    
                    <div class="code-block">
// Blog post with tags (array of strings)
{
  "_id": ObjectId("..."),
  "title": "MongoDB Best Practices",
  "tags": ["mongodb", "database", "nosql", "performance"],
  "categories": ["tech", "tutorial"]
}

// User with multiple skills (array of objects)
{
  "_id": ObjectId("..."),
  "name": "Jane Developer",
  "skills": [
    {"name": "JavaScript", "level": "expert"},
    {"name": "Python", "level": "intermediate"},
    {"name": "MongoDB", "level": "advanced"}
  ]
}
                    </div>

                    <div class="query-demo">
                        <h4>🔍 Querying Arrays</h4>
                        <div class="code-block">
// Find posts with specific tag
db.posts.find({"tags": "mongodb"})

// Find users with JavaScript skills
db.users.find({"skills.name": "JavaScript"})

// Find expert level skills
db.users.find({"skills.level": "expert"})
                        </div>
                    </div>
                </div>

                <!-- Embedded Documents Section -->
                <div class="feature-section">
                    <div class="feature-title">🗂️ Embedded Documents</div>
                    
                    <div class="code-block">
// E-commerce order with embedded data
{
  "_id": ObjectId("..."),
  "order_id": "ORD-001",
  "customer": {
    "name": "John Smith",
    "email": "john@example.com",
    "address": {
      "street": "123 Main St",
      "city": "San Francisco",
      "zip": "94105"
    }
  },
  "items": [
    {
      "product_id": "PROD-1",
      "name": "Laptop",
      "price": 999.99,
      "quantity": 1
    },
    {
      "product_id": "PROD-2", 
      "name": "Mouse",
      "price": 29.99,
      "quantity": 2
    }
  ],
  "total": 1059.97,
  "status": "shipped"
}
                    </div>

                    <div class="query-demo">
                        <h4>🔍 Querying Embedded Documents</h4>
                        <div class="code-block">
// Find orders by customer city
db.orders.find({"customer.address.city": "San Francisco"})

// Find orders with specific product
db.orders.find({"items.product_id": "PROD-1"})

// Find high-value orders
db.orders.find({"total": {$gt: 1000}})
                        </div>
                    </div>
                </div>

                <div class="simulation-container">
                    <h4>🎮 Interactive Demo</h4>
                    <div class="simulation-controls">
                        <button class="btn btn-primary" onclick="mongoAddBlogPost()">Add Blog Post</button>
                        <button class="btn btn-primary" onclick="mongoAddOrder()">Add Order</button>
                        <button class="btn btn-primary" onclick="mongoQueryData()">Query Data</button>
                        <button class="btn btn-secondary" onclick="mongoReset()">Reset</button>
                    </div>
                    <div class="data-display" id="mongoData"></div>
                    <div id="mongoLog"></div>
                </div>

                <div class="benefits">
                    <h4>✅ Benefits</h4>
                    <ul>
                        <li><span class="icon">⚡</span> Single query retrieves complete objects</li>
                        <li><span class="icon">🎯</span> Natural array operations ($push, $pull, $addToSet)</li>
                        <li><span class="icon">🔍</span> Rich query operators for arrays and nested docs</li>
                        <li><span class="icon">📦</span> Data locality improves performance</li>
                        <li><span class="icon">🚀</span> No complex JOINs required</li>
                    </ul>
                </div>
            </div>

            <!-- Relational Database Side -->
            <div class="side relational">
                <h2>
                    <div class="logo relational">SQL</div>
                    Relational Database Approach
                </h2>

                <!-- Junction Tables Section -->
                <div class="feature-section">
                    <div class="feature-title relational">🔗 Junction Tables for Arrays</div>
                    
                    <div class="code-block">
-- Posts table
CREATE TABLE posts (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255),
    content TEXT
);

-- Tags table  
CREATE TABLE tags (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) UNIQUE
);

-- Junction table for many-to-many
CREATE TABLE post_tags (
    post_id INTEGER REFERENCES posts(id),
    tag_id INTEGER REFERENCES tags(id),
    PRIMARY KEY (post_id, tag_id)
);

-- User skills require separate table
CREATE TABLE user_skills (
    user_id INTEGER REFERENCES users(id),
    skill_name VARCHAR(100),
    skill_level VARCHAR(50),
    PRIMARY KEY (user_id, skill_name)
);
                    </div>

                    <div class="query-demo relational">
                        <h4>🔍 Complex JOINs Required</h4>
                        <div class="code-block">
-- Find posts with specific tag
SELECT p.* FROM posts p
JOIN post_tags pt ON p.id = pt.post_id
JOIN tags t ON pt.tag_id = t.id
WHERE t.name = 'mongodb';

-- Find users with JavaScript skills
SELECT u.* FROM users u
JOIN user_skills us ON u.id = us.user_id
WHERE us.skill_name = 'JavaScript';
                        </div>
                    </div>
                </div>

                <!-- Normalized Tables Section -->
                <div class="feature-section">
                    <div class="feature-title relational">📋 Normalized Tables</div>
                    
                    <div class="code-block">
-- Orders table
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    order_id VARCHAR(50),
    customer_id INTEGER REFERENCES customers(id),
    total DECIMAL(10,2),
    status VARCHAR(50)
);

-- Customers table
CREATE TABLE customers (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255),
    email VARCHAR(255)
);

-- Addresses table
CREATE TABLE addresses (
    id SERIAL PRIMARY KEY,
    customer_id INTEGER REFERENCES customers(id),
    street VARCHAR(255),
    city VARCHAR(100),
    zip VARCHAR(20)
);

-- Order items table
CREATE TABLE order_items (
    order_id INTEGER REFERENCES orders(id),
    product_id VARCHAR(50),
    name VARCHAR(255),
    price DECIMAL(8,2),
    quantity INTEGER
);
                    </div>

                    <div class="query-demo relational">
                        <h4>🔍 Multi-table JOINs</h4>
                        <div class="code-block">
-- Get complete order information
SELECT o.order_id, c.name, a.city, 
       oi.name as item_name, oi.quantity
FROM orders o
JOIN customers c ON o.customer_id = c.id
JOIN addresses a ON c.id = a.customer_id
JOIN order_items oi ON o.id = oi.order_id
WHERE o.order_id = 'ORD-001';
                        </div>
                    </div>
                </div>

                <div class="simulation-container">
                    <h4>🎮 Interactive Demo</h4>
                    <div class="simulation-controls">
                        <button class="btn btn-danger" onclick="sqlAddBlogPost()">Add Blog Post</button>
                        <button class="btn btn-danger" onclick="sqlAddOrder()">Add Order</button>
                        <button class="btn btn-danger" onclick="sqlQueryData()">Query Data</button>
                        <button class="btn btn-secondary" onclick="sqlReset()">Reset</button>
                    </div>
                    <div class="table-display" id="sqlData"></div>
                    <div id="sqlLog"></div>
                </div>

                <div class="benefits relational">
                    <h4>⚠️ Complexity</h4>
                    <ul>
                        <li><span class="icon">🔗</span> Multiple tables for simple relationships</li>
                        <li><span class="icon">🔄</span> Complex JOINs for data retrieval</li>
                        <li><span class="icon">📊</span> Additional foreign key management</li>
                        <li><span class="icon">⚡</span> Potential performance overhead</li>
                        <li><span class="icon">🔧</span> More maintenance and schema complexity</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Summary Section -->
        <div style="background: white; border-radius: 15px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
            <h2 style="text-align: center; color: #333; margin-bottom: 30px;">Performance & Complexity Comparison</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <div>
                    <h3 style="color: #00684A; margin-bottom: 15px;">🍃 MongoDB: Atomic Operations</h3>
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin: 10px 0; padding: 10px; background: #e8f5e8; border-radius: 5px;">
                            <strong>Single Query:</strong> Retrieve complete nested objects
                        </li>
                        <li style="margin: 10px 0; padding: 10px; background: #e8f5e8; border-radius: 5px;">
                            <strong>Array Operations:</strong> $push, $pull, $addToSet directly on arrays
                        </li>
                        <li style="margin: 10px 0; padding: 10px; background: #e8f5e8; border-radius: 5px;">
                            <strong>Data Locality:</strong> Related data stored together
                        </li>
                    </ul>
                </div>
                
                <div>
                    <h3 style="color: #D32F2F; margin-bottom: 15px;">🗄️ SQL: Normalized Approach</h3>
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin: 10px 0; padding: 10px; background: #fde8e8; border-radius: 5px;">
                            <strong>Multiple Queries:</strong> JOINs across several tables
                        </li>
                        <li style="margin: 10px 0; padding: 10px; background: #fde8e8; border-radius: 5px;">
                            <strong>Junction Tables:</strong> Extra tables for simple arrays
                        </li>
                        <li style="margin: 10px 0; padding: 10px; background: #fde8e8; border-radius: 5px;">
                            <strong>Referential Integrity:</strong> Strong consistency guarantees
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // MongoDB Simulation State
        let mongoBlogPosts = [];
        let mongoOrders = [];
        let mongoPostId = 1;
        let mongoOrderId = 1;

        // SQL Simulation State
        let sqlPosts = [];
        let sqlTags = [];
        let sqlPostTags = [];
        let sqlOrders = [];
        let sqlCustomers = [];
        let sqlAddresses = [];
        let sqlOrderItems = [];
        let sqlPostId = 1;
        let sqlTagId = 1;
        let sqlOrderId = 1;
        let sqlCustomerId = 1;

        // Initialize displays
        function init() {
            mongoReset();
            sqlReset();
        }

        // MongoDB Functions
        function mongoAddBlogPost() {
            const tags = ['mongodb', 'nosql', 'database', 'javascript', 'tutorial'];
            const selectedTags = tags.sort(() => 0.5 - Math.random()).slice(0, Math.floor(Math.random() * 3) + 2);
            
            const newPost = {
                _id: mongoPostId++,
                title: `MongoDB Tutorial ${mongoPostId - 1}`,
                content: "Learn about MongoDB's flexible document model...",
                tags: selectedTags,
                author: {
                    name: "John Doe",
                    email: "john@example.com",
                    bio: "Database expert"
                },
                metadata: {
                    views: Math.floor(Math.random() * 1000),
                    likes: Math.floor(Math.random() * 100),
                    created_at: new Date().toISOString()
                }
            };
            
            mongoBlogPosts.push(newPost);
            updateMongoDisplay();
            mongoLog(`✅ Added blog post with ${selectedTags.length} tags and embedded author info`);
        }

        function mongoAddOrder() {
            const items = [
                {product_id: "PROD-1", name: "Laptop", price: 999.99, quantity: 1},
                {product_id: "PROD-2", name: "Mouse", price: 29.99, quantity: 2},
                {product_id: "PROD-3", name: "Keyboard", price: 79.99, quantity: 1}
            ];
            const selectedItems = items.sort(() => 0.5 - Math.random()).slice(0, Math.floor(Math.random() * 2) + 1);
            const total = selectedItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            const newOrder = {
                _id: mongoOrderId++,
                order_id: `ORD-${String(mongoOrderId - 1).padStart(3, '0')}`,
                customer: {
                    name: `Customer ${mongoOrderId - 1}`,
                    email: `customer${mongoOrderId - 1}@example.com`,
                    address: {
                        street: "123 Main St",
                        city: "San Francisco",
                        zip: "94105"
                    }
                },
                items: selectedItems,
                total: Math.round(total * 100) / 100,
                status: "pending",
                created_at: new Date().toISOString()
            };
            
            mongoOrders.push(newOrder);
            updateMongoDisplay();
            mongoLog(`✅ Added order with ${selectedItems.length} items and embedded customer data`);
        }

        function mongoQueryData() {
            if (mongoBlogPosts.length === 0 && mongoOrders.length === 0) {
                mongoLog('❌ No data to query. Add some posts or orders first!');
                return;
            }
            
            const queries = [];
            
            if (mongoBlogPosts.length > 0) {
                const randomPost = mongoBlogPosts[Math.floor(Math.random() * mongoBlogPosts.length)];
                const randomTag = randomPost.tags[0];
                queries.push(`Posts with tag "${randomTag}": ${mongoBlogPosts.filter(p => p.tags.includes(randomTag)).length} found`);
            }
            
            if (mongoOrders.length > 0) {
                const highValueOrders = mongoOrders.filter(o => o.total > 500);
                queries.push(`High-value orders (>$500): ${highValueOrders.length} found`);
                
                const sfOrders = mongoOrders.filter(o => o.customer.address.city === "San Francisco");
                queries.push(`Orders from San Francisco: ${sfOrders.length} found`);
            }
            
            queries.forEach(query => mongoLog(`🔍 ${query}`));
        }

        function mongoReset() {
            mongoBlogPosts = [];
            mongoOrders = [];
            mongoPostId = 1;
            mongoOrderId = 1;
            updateMongoDisplay();
            document.getElementById('mongoLog').innerHTML = '';
            mongoLog('🔄 Reset MongoDB data');
        }

        function updateMongoDisplay() {
            const display = document.getElementById('mongoData');
            const data = {
                blog_posts: mongoBlogPosts,
                orders: mongoOrders
            };
            display.textContent = JSON.stringify(data, null, 2);
        }

        function mongoLog(message) {
            const log = document.getElementById('mongoLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        // SQL Functions
        function sqlAddBlogPost() {
            const tags = ['mongodb', 'nosql', 'database', 'javascript', 'tutorial'];
            const selectedTags = tags.sort(() => 0.5 - Math.random()).slice(0, Math.floor(Math.random() * 3) + 2);
            
            // Add post
            const newPost = {
                id: sqlPostId++,
                title: `SQL Tutorial ${sqlPostId - 1}`,
                content: "Learn about relational databases..."
            };
            sqlPosts.push(newPost);
            
            // Add tags and junction records
            selectedTags.forEach(tagName => {
                let tag = sqlTags.find(t => t.name === tagName);
                if (!tag) {
                    tag = { id: sqlTagId++, name: tagName };
                    sqlTags.push(tag);
                }
                
                sqlPostTags.push({
                    post_id: newPost.id,
                    tag_id: tag.id
                });
            });
            
            updateSqlDisplay();
            sqlLog(`✅ Added blog post requiring ${selectedTags.length + 1} table insertions`);
        }

        function sqlAddOrder() {
            const items = [
                {product_id: "PROD-1", name: "Laptop", price: 999.99, quantity: 1},
                {product_id: "PROD-2", name: "Mouse", price: 29.99, quantity: 2}
            ];
            const selectedItems = items.sort(() => 0.5 - Math.random()).slice(0, Math.floor(Math.random() * 2) + 1);
            const total = selectedItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            // Add customer
            const newCustomer = {
                id: sqlCustomerId++,
                name: `Customer ${sqlCustomerId - 1}`,
                email: `customer${sqlCustomerId - 1}@example.com`
            };
            sqlCustomers.push(newCustomer);
            
            // Add address
            const newAddress = {
                id: sqlCustomerId,
                customer_id: newCustomer.id,
                street: "123 Main St",
                city: "San Francisco",
                zip: "94105"
            };
            sqlAddresses.push(newAddress);
            
            // Add order
            const newOrder = {
                id: sqlOrderId++,
                order_id: `ORD-${String(sqlOrderId - 1).padStart(3, '0')}`,
                customer_id: newCustomer.id,
                total: Math.round(total * 100) / 100,
                status: "pending"
            };
            sqlOrders.push(newOrder);
            
            // Add order items
            selectedItems.forEach(item => {
                sqlOrderItems.push({
                    order_id: newOrder.id,
                    product_id: item.product_id,
                    name: item.name,
                    price: item.price,
                    quantity: item.quantity
                });
            });
            
            updateSqlDisplay();
            sqlLog(`✅ Added order requiring ${3 + selectedItems.length} table insertions`);
        }

        function sqlQueryData() {
            if (sqlPosts.length === 0 && sqlOrders.length === 0) {
                sqlLog('❌ No data to query. Add some posts or orders first!');
                return;
            }
            
            const queries = [];
            
            if (sqlPosts.length > 0 && sqlTags.length > 0) {
                const randomTag = sqlTags[Math.floor(Math.random() * sqlTags.length)];
                const postCount = sqlPostTags.filter(pt => pt.tag_id === randomTag.id).length;
                queries.push(`Posts with tag "${randomTag.name}": ${postCount} (requires 3-table JOIN)`);
            }
            
            if (sqlOrders.length > 0) {
                const highValueOrders = sqlOrders.filter(o => o.total > 500);
                queries.push(`High-value orders: ${highValueOrders.length} (single table query)`);
                
                const sfCustomers = sqlAddresses.filter(a => a.city === "San Francisco");
                const sfOrders = sqlOrders.filter(o => 
                    sfCustomers.some(addr => addr.customer_id === o.customer_id)
                );
                queries.push(`SF orders: ${sfOrders.length} (requires 3-table JOIN)`);
            }
            
            queries.forEach(query => sqlLog(`🔍 ${query}`));
        }

        function sqlReset() {
            sqlPosts = [];
            sqlTags = [];
            sqlPostTags = [];
            sqlOrders = [];
            sqlCustomers = [];
            sqlAddresses = [];
            sqlOrderItems = [];
            sqlPostId = 1;
            sqlTagId = 1;
            sqlOrderId = 1;
            sqlCustomerId = 1;
            updateSqlDisplay();
            document.getElementById('sqlLog').innerHTML = '';
            sqlLog('🔄 Reset SQL data');
        }

        function updateSqlDisplay() {
            const display = document.getElementById('sqlData');
            let html = '';
            
            if (sqlPosts.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">📋 POSTS TABLE</div>';
                html += 'id | title | content\n';
                html += '---|-------|--------\n';
                sqlPosts.forEach(post => {
                    html += `${post.id} | ${post.title} | ${post.content.substring(0, 30)}...\n`;
                });
                html += '</div>';
            }
            
            if (sqlTags.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">🏷️ TAGS TABLE</div>';
                html += 'id | name\n';
                html += '---|-----\n';
                sqlTags.forEach(tag => {
                    html += `${tag.id} | ${tag.name}\n`;
                });
                html += '</div>';
            }
            
            if (sqlPostTags.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">🔗 POST_TAGS TABLE (Junction)</div>';
                html += 'post_id | tag_id\n';
                html += '--------|-------\n';
                sqlPostTags.forEach(pt => {
                    html += `${pt.post_id} | ${pt.tag_id}\n`;
                });
                html += '</div>';
            }
            
            if (sqlCustomers.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">👤 CUSTOMERS TABLE</div>';
                html += 'id | name | email\n';
                html += '---|------|------\n';
                sqlCustomers.forEach(customer => {
                    html += `${customer.id} | ${customer.name} | ${customer.email}\n`;
                });
                html += '</div>';
            }
            
            if (sqlAddresses.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">🏠 ADDRESSES TABLE</div>';
                html += 'id | customer_id | street | city | zip\n';
                html += '---|------------|--------|------|----\n';
                sqlAddresses.forEach(addr => {
                    html += `${addr.id} | ${addr.customer_id} | ${addr.street} | ${addr.city} | ${addr.zip}\n`;
                });
                html += '</div>';
            }
            
            if (sqlOrders.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">📦 ORDERS TABLE</div>';
                html += 'id | order_id | customer_id | total | status\n';
                html += '---|----------|-------------|-------|-------\n';
                sqlOrders.forEach(order => {
                    html += `${order.id} | ${order.order_id} | ${order.customer_id} | ${order.total} | ${order.status}\n`;
                });
                html += '</div>';
            }
            
            if (sqlOrderItems.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">📋 ORDER_ITEMS TABLE</div>';
                html += 'order_id | product_id | name | price | quantity\n';
                html += '---------|------------|------|-------|----------\n';
                sqlOrderItems.forEach(item => {
                    html += `${item.order_id} | ${item.product_id} | ${item.name} | ${item.price} | ${item.quantity}\n`;
                });
                html += '</div>';
            }
            
            if (html === '') {
                html = 'No data yet. Add some blog posts or orders to see the normalized table structure.';
            }
            
            display.innerHTML = html;
        }

        function sqlLog(message) {
            const log = document.getElementById('sqlLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        // Toggle demo overview section
        function toggleDemoOverview() {
            var overview = document.getElementById('demoOverview');
            var toggle = document.getElementById('demoToggle');
            
            if (overview.style.display === 'none') {
                overview.style.display = 'block';
                toggle.textContent = '▲';
                toggle.style.transform = 'rotate(180deg)';
            } else {
                overview.style.display = 'none';
                toggle.textContent = '▼';
                toggle.style.transform = 'rotate(0deg)';
            }
        }

        // Mobile menu functionality
        function toggleMobileMenu() {
            const navMenu = document.getElementById('navMenu');
            navMenu.classList.toggle('open');
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const navMenu = document.getElementById('navMenu');
            const toggleButton = document.querySelector('.mobile-menu-toggle');
            
            if (!navMenu.contains(event.target) && !toggleButton.contains(event.target)) {
                navMenu.classList.remove('open');
            }
        });

        // Accordion functionality
        function toggleAccordion(categoryId) {
            const content = document.getElementById(categoryId + '-content');
            const icon = document.getElementById(categoryId + '-icon');
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                icon.classList.remove('rotated');
            } else {
                content.classList.add('expanded');
                icon.classList.add('rotated');
            }
        }

        // Initialize accordion - expand category containing current page
        function initializeAccordion() {
            const content = document.getElementById('development-content');
            const icon = document.getElementById('development-icon');
            content.classList.add('expanded');
            icon.classList.add('rotated');
        }

        // Initialize on page load
        window.addEventListener('load', function() {
            initializeAccordion();
            init();
        });
    </script>
</body>
</html>
