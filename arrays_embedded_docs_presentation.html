<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YCV5KGB8ES"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-YCV5KGB8ES');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arrays & Embedded Documents: MongoDB vs PostgreSQL</title>
    <link rel="stylesheet" href="shared-theme.css">
    <style>
        /* Page-specific styles */
        .page-container {
            padding: 40px;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        /* Component-specific styles */

        /* Header */
        .header {
            background: var(--surface);
            backdrop-filter: blur(20px);
            padding: 40px;
            border-radius: var(--radius-lg);
            box-shadow: 0 4px 12px var(--shadow-md);
            margin-bottom: 30px;
            border: 1px solid var(--border);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-blue) 100%);
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        }

        .header h1 {
            color: var(--primary-dark);
            margin-bottom: 15px;
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-primary);
            font-weight: 300;
            opacity: 0.8;
            margin-bottom: 30px;
        }

        /* So What Section */
        .so-what-section {
            background: var(--surface);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-lg);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px var(--shadow-md);
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .so-what-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-blue) 100%);
        }

        .so-what-title {
            color: var(--primary-dark);
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .so-what-text {
            color: var(--text-primary);
            font-size: 1.1rem;
            line-height: 1.7;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .real-impact-box {
            background: var(--gradient-dark);
            color: white;
            padding: 25px;
            border-radius: var(--border-radius-md);
            margin-top: 20px;
            position: relative;
            overflow: hidden;
        }

        .real-impact-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-blue) 100%);
        }

        .real-impact-text {
            font-weight: 600;
            font-size: 1.05rem;
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }

        /* Demo Overview */
        .demo-overview-section {
            background: var(--surface);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-lg);
            box-shadow: 0 4px 12px var(--shadow-md);
            margin-bottom: 30px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .demo-toggle-header {
            padding: 25px 30px;
            background: var(--surface-light);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .demo-toggle-header:hover {
            background: var(--primary-light);
        }

        .demo-toggle-title {
            font-size: 1.4rem;
            color: var(--primary-dark);
            font-weight: 700;
        }

        .demo-toggle-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
            color: var(--primary-dark);
        }

        .demo-content {
            padding: 30px;
        }

        .scenario-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        .scenario-card {
            padding: 25px;
            border-radius: 15px;
            border-left: 4px solid;
            position: relative;
            overflow: hidden;
        }

        .mongo-scenario {
            background: var(--primary-light);
            border-left-color: var(--accent-primary);
        }

        .sql-scenario {
            background: var(--danger-light);
            border-left-color: var(--danger-primary);
        }

        .scenario-title {
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: 700;
        }

        .mongo-title {
            color: var(--primary-dark);
        }

        .sql-title {
            color: var(--danger-primary);
        }

        .scenario-list {
            list-style: none;
        }

        .scenario-list li {
            padding: 8px 0;
            position: relative;
            padding-left: 25px;
            line-height: 1.6;
        }

        .scenario-list li::before {
            content: "▶";
            position: absolute;
            left: 0;
            color: var(--primary-dark);
            font-size: 0.8rem;
        }

        .sql-scenario .scenario-list li::before {
            color: var(--danger-primary);
        }

        .learning-points {
            background: var(--surface-light);
            padding: 25px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
        }

        .learning-title {
            color: var(--primary-dark);
            margin-bottom: 20px;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .points-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .learning-point {
            padding: 20px;
            background: white;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            border-left: 4px solid var(--accent-primary);
            transition: transform 0.3s ease;
        }

        .learning-point:hover {
            transform: translateY(-5px);
        }

        .point-title {
            color: var(--primary-dark);
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .point-description {
            color: var(--text-primary);
            opacity: 0.8;
            line-height: 1.6;
        }

        /* Comparison Section */
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .side {
            background: var(--surface);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-lg);
            padding: 30px;
            box-shadow: 0 4px 12px var(--shadow-md);
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .side::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-blue) 100%);
        }

        .side.relational::before {
            background: var(--gradient-danger);
        }

        .side h2 {
            color: var(--primary-dark);
            margin-bottom: 25px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 700;
        }

        .side.relational h2 {
            color: var(--danger-primary);
        }

        .logo {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-blue) 100%);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
            font-weight: 700;
            font-size: 1.4rem;
            box-shadow: var(--shadow-primary);
        }

        .logo.relational {
            background: var(--gradient-danger);
            color: white;
        }

        .feature-section {
            margin-bottom: 30px;
        }

        .feature-title {
            background: var(--primary-light);
            padding: 18px 25px;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
            border-left: 4px solid var(--accent-primary);
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-dark);
        }

        .feature-title.relational {
            background: var(--danger-light);
            border-left-color: var(--danger-primary);
            color: var(--danger-primary);
        }

        .code-block {
            background: #1e1e1e;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 15px 0;
            overflow-x: auto;
            line-height: 1.6;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .query-demo {
            background: var(--primary-light);
            padding: 20px;
            border-radius: var(--radius-md);
            margin: 20px 0;
            border-left: 4px solid var(--accent-primary);
        }

        .query-demo.relational {
            background: var(--danger-light);
            border-left-color: var(--danger-primary);
        }

        .query-demo h4 {
            color: var(--primary-dark);
            margin-bottom: 15px;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .query-demo.relational h4 {
            color: var(--danger-primary);
        }

        /* Interactive Demo */
        .simulation-container {
            background: var(--surface-light);
            border-radius: var(--radius-md);
            padding: 25px;
            margin: 25px 0;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-sm);
        }

        .simulation-container h4 {
            color: var(--primary-dark);
            margin-bottom: 20px;
            font-weight: 700;
            font-size: 1.3rem;
        }

        .simulation-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-blue) 100%);
            color: var(--text-primary);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--secondary-color) 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-primary);
        }

        .btn-danger {
            background: var(--gradient-danger);
            color: white;
        }

        .btn-danger:hover {
            background: var(--gradient-danger-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-danger);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #495057 0%, #343a40 100%);
            transform: translateY(-2px);
        }

        .data-display, .table-display {
            background: #1e1e1e;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            line-height: 1.5;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .table-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #4a5568;
        }

        .table-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .table-title {
            color: #00ED64;
            font-weight: 700;
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .log-entry {
            margin: 8px 0;
            padding: 8px 12px;
            border-left: 3px solid var(--accent-primary);
            background: var(--primary-light);
            font-size: 0.9rem;
            border-radius: var(--radius-sm);
        }

        .log-entry.error {
            border-left-color: var(--danger-primary);
            background: var(--danger-light);
        }

        .benefits {
            background: var(--primary-light);
            padding: 20px;
            border-radius: var(--radius-md);
            margin-top: 20px;
            border: 1px solid var(--primary-border);
        }

        .benefits.relational {
            background: var(--danger-light);
            border-color: var(--danger-border);
        }

        .benefits h4 {
            color: var(--primary-dark);
            margin-bottom: 15px;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .benefits.relational h4 {
            color: var(--danger-primary);
        }

        .benefits ul {
            list-style: none;
            padding: 0;
        }

        .benefits li {
            margin: 10px 0;
            padding: 8px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            line-height: 1.6;
        }

        .icon {
            font-size: 1.2rem;
        }

        /* Summary Section */
        .summary-section {
            background: var(--surface);
            backdrop-filter: blur(20px);
            border-radius: var(--radius-lg);
            padding: 40px;
            box-shadow: 0 4px 12px var(--shadow-md);
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .summary-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--accent-blue) 100%);
        }

        .summary-section h2 {
            text-align: center;
            color: var(--primary-dark);
            margin-bottom: 30px;
            font-size: 2rem;
            font-weight: 700;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .summary-card {
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 30, 43, 0.1);
        }

        .mongo-summary {
            background: var(--primary-light);
            border: 1px solid var(--primary-border);
        }

        .sql-summary {
            background: var(--danger-light);
            border: 1px solid var(--danger-border);
        }

        .summary-card h3 {
            margin-bottom: 20px;
            font-weight: 700;
            font-size: 1.3rem;
        }

        .mongo-summary h3 {
            color: var(--primary-dark);
        }

        .sql-summary h3 {
            color: var(--danger-primary);
        }

        .summary-card ul {
            list-style: none;
            padding: 0;
        }

        .summary-card li {
            margin: 12px 0;
            padding: 12px 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 30, 43, 0.05);
            line-height: 1.6;
        }

        .summary-card strong {
            color: var(--primary-dark);
        }

        .sql-summary strong {
            color: var(--danger-primary);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .page-container {
                padding: 30px;
            }
            
            .comparison,
            .scenario-grid,
            .points-grid,
            .summary-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }

        @media (max-width: 768px) {
            .page-container {
                padding: 20px;
            }
            
            .header {
                padding: 30px 25px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .simulation-controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .page-container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .so-what-section,
            .demo-content,
            .side,
            .summary-section {
                padding: 20px;
            }
        }

        /* Accessibility */
        button:focus,
        a:focus {
            outline: 3px solid #00ED64;
            outline-offset: 2px;
        }

        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <header class="unified-header">
        <div class="header-content">
            <a href="playground.html" class="header-logo">
                <div class="logo-icon">M</div>
                <span>MongoDB Playground</span>
            </a>
            <div class="breadcrumb">
                <a href="playground.html">Playground</a>
                <span class="breadcrumb-separator">></span>
                <span>Data Modeling</span>
            </div>
            <a href="playground.html" class="back-to-playground">← Back to Playground</a>
        </div>
    </header>

    <main class="page-container">
        <header class="header">
            <h1>Arrays & Embedded Documents vs PostgreSQL JOINs</h1>
            <p class="subtitle">Natural Data Relationships vs Normalized Complexity</p>
        </header>

        <!-- So What Section -->
        <div class="so-what-section">
            <h2 class="so-what-title">🚀 Why This Matters: The Natural Data Advantage</h2>
            <p class="so-what-text">
                Most applications deal with <strong>complex, nested data</strong> - users with multiple skills, orders with line items, blog posts with tags. Relational databases force you to break these natural relationships into separate tables, requiring complex JOINs that hurt performance and complicate your code.
            </p>
            <p class="so-what-text">
                <strong>MongoDB's differentiator:</strong> Store data the way your application thinks about it. Arrays and embedded documents let you model real-world relationships naturally, eliminate JOINs, and retrieve complete objects in a single query.
            </p>
            <div class="real-impact-box">
                <div class="real-impact-text">
                    <strong>Real Impact:</strong> 50-80% fewer database queries, simpler application code, and blazing-fast performance for complex data relationships that would require multiple JOINs in SQL.
                </div>
            </div>
        </div>

        <!-- Expandable Demo Overview -->
        <div class="demo-overview-section">
            <div class="demo-toggle-header" onclick="toggleDemoOverview()">
                <h3 class="demo-toggle-title">📋 What This Demo Shows</h3>
                <span id="demoToggle" class="demo-toggle-icon">▼</span>
            </div>
            
            <div id="demoOverview" style="display: none;" class="demo-content">
                <div class="scenario-grid">
                    <div class="scenario-card mongo-scenario">
                        <h4 class="scenario-title mongo-title">🍃 MongoDB Scenario</h4>
                        <ul class="scenario-list">
                            <li>Blog post with multiple tags stored as <strong>native array</strong></li>
                            <li>E-commerce order with customer data and line items <strong>embedded</strong></li>
                            <li>Single query retrieves complete objects</li>
                            <li>Rich query operators for arrays and nested documents</li>
                            <li><strong>No JOINs, maximum performance</strong></li>
                        </ul>
                    </div>
                    
                    <div class="scenario-card sql-scenario">
                        <h4 class="scenario-title sql-title">🗄️ SQL Scenario</h4>
                        <ul class="scenario-list">
                            <li>Blog tags require <strong>separate junction table</strong></li>
                            <li>Order data split across <strong>4+ tables</strong></li>
                            <li>Complex JOINs needed for simple queries</li>
                            <li>Foreign key management overhead</li>
                            <li><strong>Performance penalty, code complexity</strong></li>
                        </ul>
                    </div>
                </div>
                
                <div class="learning-points">
                    <h4 class="learning-title">🎯 Key Learning Points</h4>
                    <div class="points-grid">
                        <div class="learning-point">
                            <div class="point-title">📊 Data Modeling</div>
                            <div class="point-description">See how MongoDB mirrors real-world object relationships</div>
                        </div>
                        <div class="learning-point">
                            <div class="point-title">⚡ Query Performance</div>
                            <div class="point-description">Compare single queries vs. complex JOINs</div>
                        </div>
                        <div class="learning-point">
                            <div class="point-title">🔍 Query Operators</div>
                            <div class="point-description">Explore MongoDB's rich array and object query capabilities</div>
                        </div>
                        <div class="learning-point">
                            <div class="point-title">🏗️ Schema Complexity</div>
                            <div class="point-description">Simple documents vs. normalized table structures</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="comparison">
            <!-- MongoDB Side -->
            <div class="side mongodb">
                <h2>
                    <div class="logo">M</div>
                    MongoDB Approach
                </h2>

                <!-- Arrays Section -->
                <div class="feature-section">
                    <div class="feature-title">📊 Native Array Support</div>
                    
                    <div class="code-block">// Blog post with tags (array of strings)
{
  "_id": ObjectId("..."),
  "title": "MongoDB Best Practices",
  "tags": ["mongodb", "database", "nosql", "performance"],
  "categories": ["tech", "tutorial"]
}

// User with multiple skills (array of objects)
{
  "_id": ObjectId("..."),
  "name": "Jane Developer",
  "skills": [
    {"name": "JavaScript", "level": "expert"},
    {"name": "Python", "level": "intermediate"},
    {"name": "MongoDB", "level": "advanced"}
  ]
}</div>

                    <div class="query-demo">
                        <h4>🔍 Querying Arrays</h4>
                        <div class="code-block">// Find posts with specific tag
db.posts.find({"tags": "mongodb"})

// Find users with JavaScript skills
db.users.find({"skills.name": "JavaScript"})

// Find expert level skills
db.users.find({"skills.level": "expert"})</div>
                    </div>
                </div>

                <!-- Embedded Documents Section -->
                <div class="feature-section">
                    <div class="feature-title">🗂️ Embedded Documents</div>
                    
                    <div class="code-block">// E-commerce order with embedded data
{
  "_id": ObjectId("..."),
  "order_id": "ORD-001",
  "customer": {
    "name": "John Smith",
    "email": "john@example.com",
    "address": {
      "street": "123 Main St",
      "city": "San Francisco",
      "zip": "94105"
    }
  },
  "items": [
    {
      "product_id": "PROD-1",
      "name": "Laptop",
      "price": 999.99,
      "quantity": 1
    },
    {
      "product_id": "PROD-2", 
      "name": "Mouse",
      "price": 29.99,
      "quantity": 2
    }
  ],
  "total": 1059.97,
  "status": "shipped"
}</div>

                    <div class="query-demo">
                        <h4>🔍 Querying Embedded Documents</h4>
                        <div class="code-block">// Find orders by customer city
db.orders.find({"customer.address.city": "San Francisco"})

// Find orders with specific product
db.orders.find({"items.product_id": "PROD-1"})

// Find high-value orders
db.orders.find({"total": {$gt: 1000}})</div>
                    </div>
                </div>

                <div class="simulation-container">
                    <h4>🎮 Interactive Demo</h4>
                    <div class="simulation-controls">
                        <button class="btn btn-primary" onclick="mongoAddBlogPost()">Add Blog Post</button>
                        <button class="btn btn-primary" onclick="mongoAddOrder()">Add Order</button>
                        <button class="btn btn-primary" onclick="mongoQueryData()">Query Data</button>
                        <button class="btn btn-secondary" onclick="mongoReset()">Reset</button>
                    </div>
                    <div class="data-display" id="mongoData"></div>
                    <div id="mongoLog"></div>
                </div>

                <div class="benefits">
                    <h4>✅ Benefits</h4>
                    <ul>
                        <li><span class="icon">⚡</span> Single query retrieves complete objects</li>
                        <li><span class="icon">🎯</span> Natural array operations ($push, $pull, $addToSet)</li>
                        <li><span class="icon">🔍</span> Rich query operators for arrays and nested docs</li>
                        <li><span class="icon">📦</span> Data locality improves performance</li>
                        <li><span class="icon">🚀</span> No complex JOINs required</li>
                    </ul>
                </div>
            </div>

            <!-- Relational Database Side -->
            <div class="side relational">
                <h2>
                    <div class="logo relational">SQL</div>
                    PostgreSQL Approach
                </h2>

                <!-- Junction Tables Section -->
                <div class="feature-section">
                    <div class="feature-title relational">🔗 Junction Tables for Arrays</div>
                    
                    <div class="code-block">-- Posts table
CREATE TABLE posts (
    id SERIAL PRIMARY KEY,
    title VARCHAR(255),
    content TEXT
);

-- Tags table  
CREATE TABLE tags (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) UNIQUE
);

-- Junction table for many-to-many
CREATE TABLE post_tags (
    post_id INTEGER REFERENCES posts(id),
    tag_id INTEGER REFERENCES tags(id),
    PRIMARY KEY (post_id, tag_id)
);

-- User skills require separate table
CREATE TABLE user_skills (
    user_id INTEGER REFERENCES users(id),
    skill_name VARCHAR(100),
    skill_level VARCHAR(50),
    PRIMARY KEY (user_id, skill_name)
);</div>

                    <div class="query-demo relational">
                        <h4>🔍 Complex JOINs Required</h4>
                        <div class="code-block">-- Find posts with specific tag
SELECT p.* FROM posts p
JOIN post_tags pt ON p.id = pt.post_id
JOIN tags t ON pt.tag_id = t.id
WHERE t.name = 'mongodb';

-- Find users with JavaScript skills
SELECT u.* FROM users u
JOIN user_skills us ON u.id = us.user_id
WHERE us.skill_name = 'JavaScript';</div>
                    </div>
                </div>

                <!-- Normalized Tables Section -->
                <div class="feature-section">
                    <div class="feature-title relational">📋 Normalized Tables</div>
                    
                    <div class="code-block">-- Orders table
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    order_id VARCHAR(50),
    customer_id INTEGER REFERENCES customers(id),
    total DECIMAL(10,2),
    status VARCHAR(50)
);

-- Customers table
CREATE TABLE customers (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255),
    email VARCHAR(255)
);

-- Addresses table
CREATE TABLE addresses (
    id SERIAL PRIMARY KEY,
    customer_id INTEGER REFERENCES customers(id),
    street VARCHAR(255),
    city VARCHAR(100),
    zip VARCHAR(20)
);

-- Order items table
CREATE TABLE order_items (
    order_id INTEGER REFERENCES orders(id),
    product_id VARCHAR(50),
    name VARCHAR(255),
    price DECIMAL(8,2),
    quantity INTEGER
);</div>

                    <div class="query-demo relational">
                        <h4>🔍 Multi-table JOINs</h4>
                        <div class="code-block">-- Get complete order information
SELECT o.order_id, c.name, a.city, 
       oi.name as item_name, oi.quantity
FROM orders o
JOIN customers c ON o.customer_id = c.id
JOIN addresses a ON c.id = a.customer_id
JOIN order_items oi ON o.id = oi.order_id
WHERE o.order_id = 'ORD-001';</div>
                    </div>
                </div>

                <div class="simulation-container">
                    <h4>🎮 Interactive Demo</h4>
                    <div class="simulation-controls">
                        <button class="btn btn-danger" onclick="sqlAddBlogPost()">Add Blog Post</button>
                        <button class="btn btn-danger" onclick="sqlAddOrder()">Add Order</button>
                        <button class="btn btn-danger" onclick="sqlQueryData()">Query Data</button>
                        <button class="btn btn-secondary" onclick="sqlReset()">Reset</button>
                    </div>
                    <div class="table-display" id="sqlData"></div>
                    <div id="sqlLog"></div>
                </div>

                <div class="benefits relational">
                    <h4>⚠️ Complexity</h4>
                    <ul>
                        <li><span class="icon">🔗</span> Multiple tables for simple relationships</li>
                        <li><span class="icon">🔄</span> Complex JOINs for data retrieval</li>
                        <li><span class="icon">📊</span> Additional foreign key management</li>
                        <li><span class="icon">⚡</span> Potential performance overhead</li>
                        <li><span class="icon">🔧</span> More maintenance and schema complexity</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="summary-section">
            <h2>Performance & Complexity Comparison</h2>
            
            <div class="summary-grid">
                <div class="summary-card mongo-summary">
                    <h3>🍃 MongoDB: Atomic Operations</h3>
                    <ul>
                        <li>
                            <strong>Single Query:</strong> Retrieve complete nested objects
                        </li>
                        <li>
                            <strong>Array Operations:</strong> $push, $pull, $addToSet directly on arrays
                        </li>
                        <li>
                            <strong>Data Locality:</strong> Related data stored together
                        </li>
                    </ul>
                </div>
                
                <div class="summary-card sql-summary">
                    <h3>🗄️ SQL: Normalized Approach</h3>
                    <ul>
                        <li>
                            <strong>Multiple Queries:</strong> JOINs across several tables
                        </li>
                        <li>
                            <strong>Junction Tables:</strong> Extra tables for simple arrays
                        </li>
                        <li>
                            <strong>Referential Integrity:</strong> Strong consistency guarantees
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <script>
        // MongoDB Simulation State
        let mongoBlogPosts = [];
        let mongoOrders = [];
        let mongoPostId = 1;
        let mongoOrderId = 1;

        // SQL Simulation State
        let sqlPosts = [];
        let sqlTags = [];
        let sqlPostTags = [];
        let sqlOrders = [];
        let sqlCustomers = [];
        let sqlAddresses = [];
        let sqlOrderItems = [];
        let sqlPostId = 1;
        let sqlTagId = 1;
        let sqlOrderId = 1;
        let sqlCustomerId = 1;

        // Arrays & Embedded Documents Demo Functions
        

        // Toggle demo overview section
        function toggleDemoOverview() {
            var overview = document.getElementById('demoOverview');
            var toggle = document.getElementById('demoToggle');
            
            if (overview.style.display === 'none') {
                overview.style.display = 'block';
                toggle.textContent = '▲';
            } else {
                overview.style.display = 'none';
                toggle.textContent = '▼';
            }
        }

        // Initialize displays
        function init() {
            mongoReset();
            sqlReset();
        }

        // MongoDB Functions
        function mongoAddBlogPost() {
            const tags = ['mongodb', 'nosql', 'database', 'javascript', 'tutorial'];
            const selectedTags = tags.sort(() => 0.5 - Math.random()).slice(0, Math.floor(Math.random() * 3) + 2);
            
            const newPost = {
                _id: mongoPostId++,
                title: `MongoDB Tutorial ${mongoPostId - 1}`,
                content: "Learn about MongoDB's flexible document model...",
                tags: selectedTags,
                author: {
                    name: "John Doe",
                    email: "john@example.com",
                    bio: "Database expert"
                },
                metadata: {
                    views: Math.floor(Math.random() * 1000),
                    likes: Math.floor(Math.random() * 100),
                    created_at: new Date().toISOString()
                }
            };
            
            mongoBlogPosts.push(newPost);
            updateMongoDisplay();
            mongoLog(`✅ Added blog post with ${selectedTags.length} tags and embedded author info`);
        }

        function mongoAddOrder() {
            const items = [
                {product_id: "PROD-1", name: "Laptop", price: 999.99, quantity: 1},
                {product_id: "PROD-2", name: "Mouse", price: 29.99, quantity: 2},
                {product_id: "PROD-3", name: "Keyboard", price: 79.99, quantity: 1}
            ];
            const selectedItems = items.sort(() => 0.5 - Math.random()).slice(0, Math.floor(Math.random() * 2) + 1);
            const total = selectedItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            const newOrder = {
                _id: mongoOrderId++,
                order_id: `ORD-${String(mongoOrderId - 1).padStart(3, '0')}`,
                customer: {
                    name: `Customer ${mongoOrderId - 1}`,
                    email: `customer${mongoOrderId - 1}@example.com`,
                    address: {
                        street: "123 Main St",
                        city: "San Francisco",
                        zip: "94105"
                    }
                },
                items: selectedItems,
                total: Math.round(total * 100) / 100,
                status: "pending",
                created_at: new Date().toISOString()
            };
            
            mongoOrders.push(newOrder);
            updateMongoDisplay();
            mongoLog(`✅ Added order with ${selectedItems.length} items and embedded customer data`);
        }

        function mongoQueryData() {
            if (mongoBlogPosts.length === 0 && mongoOrders.length === 0) {
                mongoLog('❌ No data to query. Add some posts or orders first!');
                return;
            }
            
            const queries = [];
            
            if (mongoBlogPosts.length > 0) {
                const randomPost = mongoBlogPosts[Math.floor(Math.random() * mongoBlogPosts.length)];
                const randomTag = randomPost.tags[0];
                queries.push(`Posts with tag "${randomTag}": ${mongoBlogPosts.filter(p => p.tags.includes(randomTag)).length} found`);
            }
            
            if (mongoOrders.length > 0) {
                const highValueOrders = mongoOrders.filter(o => o.total > 500);
                queries.push(`High-value orders (>$500): ${highValueOrders.length} found`);
                
                const sfOrders = mongoOrders.filter(o => o.customer.address.city === "San Francisco");
                queries.push(`Orders from San Francisco: ${sfOrders.length} found`);
            }
            
            queries.forEach(query => mongoLog(`🔍 ${query}`));
        }

        function mongoReset() {
            mongoBlogPosts = [];
            mongoOrders = [];
            mongoPostId = 1;
            mongoOrderId = 1;
            updateMongoDisplay();
            document.getElementById('mongoLog').innerHTML = '';
            mongoLog('🔄 Reset MongoDB data');
        }

        function updateMongoDisplay() {
            const display = document.getElementById('mongoData');
            const data = {
                blog_posts: mongoBlogPosts,
                orders: mongoOrders
            };
            display.textContent = JSON.stringify(data, null, 2);
        }

        function mongoLog(message) {
            const log = document.getElementById('mongoLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        // SQL Functions
        function sqlAddBlogPost() {
            const tags = ['mongodb', 'nosql', 'database', 'javascript', 'tutorial'];
            const selectedTags = tags.sort(() => 0.5 - Math.random()).slice(0, Math.floor(Math.random() * 3) + 2);
            
            // Add post
            const newPost = {
                id: sqlPostId++,
                title: `SQL Tutorial ${sqlPostId - 1}`,
                content: "Learn about relational databases..."
            };
            sqlPosts.push(newPost);
            
            // Add tags and junction records
            selectedTags.forEach(tagName => {
                let tag = sqlTags.find(t => t.name === tagName);
                if (!tag) {
                    tag = { id: sqlTagId++, name: tagName };
                    sqlTags.push(tag);
                }
                
                sqlPostTags.push({
                    post_id: newPost.id,
                    tag_id: tag.id
                });
            });
            
            updateSqlDisplay();
            sqlLog(`✅ Added blog post requiring ${selectedTags.length + 1} table insertions`);
        }

        function sqlAddOrder() {
            const items = [
                {product_id: "PROD-1", name: "Laptop", price: 999.99, quantity: 1},
                {product_id: "PROD-2", name: "Mouse", price: 29.99, quantity: 2}
            ];
            const selectedItems = items.sort(() => 0.5 - Math.random()).slice(0, Math.floor(Math.random() * 2) + 1);
            const total = selectedItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            // Add customer
            const newCustomer = {
                id: sqlCustomerId++,
                name: `Customer ${sqlCustomerId - 1}`,
                email: `customer${sqlCustomerId - 1}@example.com`
            };
            sqlCustomers.push(newCustomer);
            
            // Add address
            const newAddress = {
                id: sqlCustomerId,
                customer_id: newCustomer.id,
                street: "123 Main St",
                city: "San Francisco",
                zip: "94105"
            };
            sqlAddresses.push(newAddress);
            
            // Add order
            const newOrder = {
                id: sqlOrderId++,
                order_id: `ORD-${String(sqlOrderId - 1).padStart(3, '0')}`,
                customer_id: newCustomer.id,
                total: Math.round(total * 100) / 100,
                status: "pending"
            };
            sqlOrders.push(newOrder);
            
            // Add order items
            selectedItems.forEach(item => {
                sqlOrderItems.push({
                    order_id: newOrder.id,
                    product_id: item.product_id,
                    name: item.name,
                    price: item.price,
                    quantity: item.quantity
                });
            });
            
            updateSqlDisplay();
            sqlLog(`✅ Added order requiring ${3 + selectedItems.length} table insertions`);
        }

        function sqlQueryData() {
            if (sqlPosts.length === 0 && sqlOrders.length === 0) {
                sqlLog('❌ No data to query. Add some posts or orders first!');
                return;
            }
            
            const queries = [];
            
            if (sqlPosts.length > 0 && sqlTags.length > 0) {
                const randomTag = sqlTags[Math.floor(Math.random() * sqlTags.length)];
                const postCount = sqlPostTags.filter(pt => pt.tag_id === randomTag.id).length;
                queries.push(`Posts with tag "${randomTag.name}": ${postCount} (requires 3-table JOIN)`);
            }
            
            if (sqlOrders.length > 0) {
                const highValueOrders = sqlOrders.filter(o => o.total > 500);
                queries.push(`High-value orders: ${highValueOrders.length} (single table query)`);
                
                const sfCustomers = sqlAddresses.filter(a => a.city === "San Francisco");
                const sfOrders = sqlOrders.filter(o => 
                    sfCustomers.some(addr => addr.customer_id === o.customer_id)
                );
                queries.push(`SF orders: ${sfOrders.length} (requires 3-table JOIN)`);
            }
            
            queries.forEach(query => sqlLog(`🔍 ${query}`));
        }

        function sqlReset() {
            sqlPosts = [];
            sqlTags = [];
            sqlPostTags = [];
            sqlOrders = [];
            sqlCustomers = [];
            sqlAddresses = [];
            sqlOrderItems = [];
            sqlPostId = 1;
            sqlTagId = 1;
            sqlOrderId = 1;
            sqlCustomerId = 1;
            updateSqlDisplay();
            document.getElementById('sqlLog').innerHTML = '';
            sqlLog('🔄 Reset SQL data');
        }

        function updateSqlDisplay() {
            const display = document.getElementById('sqlData');
            let html = '';
            
            if (sqlPosts.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">📋 POSTS TABLE</div>';
                html += 'id | title | content\n';
                html += '---|-------|--------\n';
                sqlPosts.forEach(post => {
                    html += `${post.id} | ${post.title} | ${post.content.substring(0, 30)}...\n`;
                });
                html += '</div>';
            }
            
            if (sqlTags.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">🏷️ TAGS TABLE</div>';
                html += 'id | name\n';
                html += '---|-----\n';
                sqlTags.forEach(tag => {
                    html += `${tag.id} | ${tag.name}\n`;
                });
                html += '</div>';
            }
            
            if (sqlPostTags.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">🔗 POST_TAGS TABLE (Junction)</div>';
                html += 'post_id | tag_id\n';
                html += '--------|-------\n';
                sqlPostTags.forEach(pt => {
                    html += `${pt.post_id} | ${pt.tag_id}\n`;
                });
                html += '</div>';
            }
            
            if (sqlCustomers.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">👤 CUSTOMERS TABLE</div>';
                html += 'id | name | email\n';
                html += '---|------|------\n';
                sqlCustomers.forEach(customer => {
                    html += `${customer.id} | ${customer.name} | ${customer.email}\n`;
                });
                html += '</div>';
            }
            
            if (sqlAddresses.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">🏠 ADDRESSES TABLE</div>';
                html += 'id | customer_id | street | city | zip\n';
                html += '---|------------|--------|------|----\n';
                sqlAddresses.forEach(addr => {
                    html += `${addr.id} | ${addr.customer_id} | ${addr.street} | ${addr.city} | ${addr.zip}\n`;
                });
                html += '</div>';
            }
            
            if (sqlOrders.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">📦 ORDERS TABLE</div>';
                html += 'id | order_id | customer_id | total | status\n';
                html += '---|----------|-------------|-------|-------\n';
                sqlOrders.forEach(order => {
                    html += `${order.id} | ${order.order_id} | ${order.customer_id} | ${order.total} | ${order.status}\n`;
                });
                html += '</div>';
            }
            
            if (sqlOrderItems.length > 0) {
                html += '<div class="table-section">';
                html += '<div class="table-title">📋 ORDER_ITEMS TABLE</div>';
                html += 'order_id | product_id | name | price | quantity\n';
                html += '---------|------------|------|-------|----------\n';
                sqlOrderItems.forEach(item => {
                    html += `${item.order_id} | ${item.product_id} | ${item.name} | ${item.price} | ${item.quantity}\n`;
                });
                html += '</div>';
            }
            
            if (html === '') {
                html = 'No data yet. Add some blog posts or orders to see the normalized table structure.';
            }
            
            display.innerHTML = html;
        }

        function sqlLog(message) {
            const log = document.getElementById('sqlLog');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        // Initialize everything when DOM is ready
        window.addEventListener('load', function() {
            init();
        });
    </script>
</body>
</html>